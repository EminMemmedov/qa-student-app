import{t as e}from"./arrow-left-CJeLmIld.js";import{n as t,t as n}from"./user-vgNZlQAc.js";import{t as r}from"./circle-alert-BqeA137O.js";import"./circle-check-big-ZpW1P5p_.js";import{a as i,c as a,i as o,l as ee,n as s,o as c,r as l,t as te}from"./practiceSpecs-DTqsZZs8.js";import{t as u}from"./credit-card-C6rbe0P3.js";import{t as d}from"./loader-circle-_-cXdltp.js";import{t as f}from"./lock-hYQ74OPk.js";import"./sparkles-Up_RZbv-.js";import"./triangle-alert-KcZqqUDd.js";import{b as p,g as m,h,i as g,n as ne,o as re,t as ie}from"./index-BeZEgM9f.js";import{t as _}from"./useGameProgress-h_HpgAh9.js";import"./confetti.module-DdO-Js2X.js";import{t as ae}from"./PageTransition-CiJSWDBw.js";import{n as oe}from"./confetti-CS5XlM66.js";var v=p(),y=h();function b(){let{foundBugs:p,addBug:h,resetProgress:b,getBugDifficulty:x,xp:S,getBugPoints:C,deductXP:se}=_(),{newAchievement:w,checkAchievements:T}=ne(),{showAnimation:E,animationData:D,triggerBugAnimation:O}=l(),{addLog:k,addRequest:ce}=ie(),[A,j]=(0,v.useState)(``),[M,N]=(0,v.useState)(``),[P,F]=(0,v.useState)(``),[I,L]=(0,v.useState)(``),[R,z]=(0,v.useState)(!1),[B,V]=(0,v.useState)(!1),[H,U]=(0,v.useState)({}),[W,le]=(0,v.useState)({}),[G]=(0,v.useState)([{id:`card_len`,description:`Kart nömrəsi 16 rəqəmdən çox qəbul edir`,severity:`Major`,priority:`Medium`},{id:`card_char`,description:`Kart nömrəsinə hərf yazmaq olur`,severity:`Major`,priority:`Medium`},{id:`card_special`,description:`Kart nömrəsinə xüsusi simvollar daxil olur`,severity:`Minor`,priority:`Low`},{id:`name_numbers`,description:`Ad sahəsinə rəqəm yazmaq olur`,severity:`Minor`,priority:`Low`},{id:`name_short`,description:`Ad sahəsi 2 simvoldan az qəbul edir`,severity:`Minor`,priority:`Low`},{id:`name_label`,description:`Ad sahəsində label səhvi: "Kart sahibi" əvəzinə "Kart sahbi"`,severity:`Minor`,priority:`Low`},{id:`expiry_past`,description:`Keçmiş tarix seçmək mümkündür`,severity:`Critical`,priority:`High`},{id:`expiry_current`,description:`Cari ay seçilə bilir (artıq bitib)`,severity:`Major`,priority:`Medium`},{id:`cvv_visible`,description:`CVV kodu gizli deyil (görünür)`,severity:`Critical`,priority:`High`},{id:`cvv_len`,description:`CVV 3 rəqəmdən çox qəbul edir`,severity:`Major`,priority:`Medium`},{id:`cvv_letters`,description:`CVV sahəsinə hərf yazmaq olur`,severity:`Major`,priority:`Medium`},{id:`btn_typo`,description:`Düymədə hərf səhvi: "Ödəniş" əvəzinə "Ödəni"`,severity:`Minor`,priority:`Low`},{id:`btn_double`,description:`Düyməyə 2 dəfə klik ödənişi təkrarlayır`,severity:`Critical`,priority:`High`},{id:`total_wrong`,description:`Yekun məbləğ səhv hesablanıb (100 + 5 = 1005)`,severity:`Critical`,priority:`High`},{id:`amount_label`,description:`Məbləğ yazısında rəng kontrastı zəifdir`,severity:`Minor`,priority:`Low`},{id:`form_spacing`,description:`Form elementləri arasında boşluq qeyri-bərabərdir`,severity:`Minor`,priority:`Low`},{id:`card_icon`,description:`Kart ikonası yanlış rəngdədir (qırmızı əvəzinə yaşıl)`,severity:`Minor`,priority:`Low`},{id:`border_color`,description:`Focus zamanı border rəngi səhvdir`,severity:`Minor`,priority:`Low`},{id:`loading_state`,description:`Ödəniş zamanı yükləmə göstəricisi yoxdur`,severity:`Major`,priority:`Medium`},{id:`success_msg`,description:`Uğurlu ödəniş mesajı göstərilmir`,severity:`Major`,priority:`Medium`}]),[ue,K]=(0,v.useState)(!1),[q,J]=(0,v.useState)(null),Y=e=>{p.includes(e)||(J(e),K(!0))},X=e=>{let t=h(e);if(t.isNew){let n=G.find(t=>t.id===e);O({...t,bugName:n.description}),T({foundBugs:[...p,e],totalBugs:G.length,moduleBugs:{payment:G},getBugDifficulty:x})}},de=({severity:e,priority:t})=>{let n=G.find(e=>e.id===q),r=0;e===n.severity&&(r+=5),t===n.priority&&(r+=5);let i=C(x(q))+r;h(q),O({isNew:!0,points:i,bugName:n.description}),K(!1),J(null),T({foundBugs:[...p,q],totalBugs:G.length,moduleBugs:{payment:G},getBugDifficulty:x})},fe=()=>{let e={},t=[];if(A?(A.length>16&&(t.push(`card_len`),e.cardNumber=`Kart nömrəsi 16 rəqəmdən çox ola bilməz`),/[a-zA-Z]/.test(A)&&(t.push(`card_char`),e.cardNumber=`Kart nömrəsi yalnız rəqəmlərdən ibarət olmalıdır`),/[^0-9]/.test(A)&&(t.push(`card_special`),e.cardNumber=`Kart nömrəsində xüsusi simvollar ola bilməz`)):e.cardNumber=`Kart nömrəsi tələb olunur`,M?(/[0-9]/.test(M)&&(t.push(`name_numbers`),e.cardName=`Ad sahəsində rəqəmlər ola bilməz`),M.length>0&&M.length<2&&(t.push(`name_short`),e.cardName=`Ad ən azı 2 simvol olmalıdır`)):e.cardName=`Kart sahibinin adı tələb olunur`,!P)e.expiry=`Bitmə tarixi tələb olunur`;else{let n=new Date(P),r=new Date;n<r&&(t.push(`expiry_past`),e.expiry=`Keçmiş tarix seçilə bilməz`);let i=r.getMonth(),a=r.getFullYear(),o=n.getMonth();n.getFullYear()===a&&o===i&&(t.push(`expiry_current`),e.expiry=`Cari ay artıq bitib, gələcək ay seçin`)}return I?(I.length>3&&(t.push(`cvv_len`),e.cvv=`CVV 3 rəqəmdən çox ola bilməz`),/[a-zA-Z]/.test(I)&&(t.push(`cvv_letters`),e.cvv=`CVV yalnız rəqəmlərdən ibarət olmalıdır`)):e.cvv=`CVV kodu tələb olunur`,t.push(`btn_typo`),t.push(`total_wrong`),t.push(`loading_state`),t.push(`success_msg`),U(e),{isValid:Object.keys(e).length===0,detectedBugs:t}},pe=async()=>{if(B){X(`btn_double`);return}let{isValid:e,detectedBugs:t}=fe(),n=!1;if(t.forEach(e=>{X(e),p.includes(e)||(n=!0)}),!e){Object.values(H)[0];return}V(!0),k(`info`,`Starting payment processing...`,{amount:100,currency:`AZN`}),await new Promise(e=>setTimeout(e,1500)),V(!1),ce(`POST`,`https://api.bank.com/v1/payments`,500,1500,{error:`Internal Server Error`}),k(`error`,`Payment failed: Server responded with status 500`),n||console.log(`Payment processed (but no message shown to user)`)},Z=e=>{le({...W,[e]:!0})},Q=G,$=p.filter(e=>Q.find(t=>t.id===e));return(0,v.useEffect)(()=>{$.length===Q.length&&Q.length>0&&oe()},[$.length,Q.length]),(0,y.jsxs)(ae,{className:`p-6 pt-12 pb-24 min-h-screen`,children:[(0,y.jsx)(i,{isOpen:R,onClose:()=>z(!1),spec:te.payment}),(0,y.jsx)(re,{children:E&&D&&(0,y.jsx)(o,{bugName:D.bugName,points:D.points,onComplete:()=>{}})}),w&&(0,y.jsx)(g,{achievement:w,onClose:()=>{}}),(0,y.jsxs)(`header`,{className:`mb-8`,children:[(0,y.jsxs)(m,{to:`/practice`,className:`inline-flex items-center text-slate-500 mb-4 hover:text-slate-800 transition-colors`,children:[(0,y.jsx)(e,{size:20,className:`mr-1`}),`Geri qayıt`]}),(0,y.jsxs)(`div`,{className:`flex justify-between items-start`,children:[(0,y.jsxs)(`div`,{children:[(0,y.jsx)(`h1`,{className:`text-3xl font-black text-slate-900 tracking-tight mb-2`,children:`Ödəniş Səhifəsi`}),(0,y.jsxs)(`div`,{className:`flex items-center gap-2 text-slate-500 font-medium`,children:[(0,y.jsx)(a,{size:18}),(0,y.jsxs)(`p`,{children:[`Bu səhifədə `,G.length,` baq gizlənib.`]})]})]}),(0,y.jsx)(`button`,{onClick:()=>z(!0),className:`p-3 bg-indigo-100 text-indigo-600 rounded-xl hover:bg-indigo-200 transition-colors`,children:(0,y.jsx)(ee,{size:24})})]})]}),(0,y.jsxs)(`div`,{className:`bg-white p-8 rounded-[2rem] shadow-xl shadow-purple-200/50 border border-slate-100 relative overflow-hidden mb-8`,children:[(0,y.jsx)(`div`,{className:`absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-purple-500 to-pink-500`}),(0,y.jsxs)(`form`,{onSubmit:e=>{e.preventDefault(),pe()},className:`space-y-6`,children:[(0,y.jsxs)(`div`,{className:`mb-8`,children:[(0,y.jsx)(`label`,{className:`block text-sm font-bold text-slate-700 mb-2`,children:`Kart Nömrəsi`}),(0,y.jsxs)(`div`,{className:`relative`,children:[(0,y.jsx)(u,{className:`absolute left-3 top-3.5 text-green-400 cursor-pointer`,size:18,onClick:()=>Y(`card_icon`,`Kart ikonası yanlış rəngdədir (qırmızı əvəzinə yaşıl)`)}),(0,y.jsx)(`input`,{type:`text`,placeholder:`0000 0000 0000 0000`,className:`w-full pl-10 p-3 border-2 rounded-xl outline-none transition-colors ${W.cardNumber&&H.cardNumber?`border-red-300 focus:border-red-500`:`border-slate-200 focus:border-green-500`}`,value:A,onChange:e=>j(e.target.value),onBlur:()=>Z(`cardNumber`),onClick:()=>Y(`border_color`,`Focus zamanı border rəngi səhvdir`)}),W.cardNumber&&H.cardNumber&&(0,y.jsxs)(`div`,{className:`flex items-center gap-2 mt-2 text-red-600 text-sm`,children:[(0,y.jsx)(r,{size:16}),(0,y.jsx)(`span`,{children:H.cardNumber})]})]})]}),(0,y.jsxs)(`div`,{className:`mb-3`,children:[(0,y.jsx)(`label`,{className:`block text-sm font-bold text-slate-700 mb-2 cursor-pointer`,onClick:()=>Y(`name_label`,`Ad sahəsində label səhvi: "Kart sahibi" əvəzinə "Kart sahbi"`),children:`Kart sahbi`}),(0,y.jsxs)(`div`,{className:`relative`,children:[(0,y.jsx)(n,{className:`absolute left-3 top-3.5 text-slate-400`,size:18}),(0,y.jsx)(`input`,{type:`text`,placeholder:`Ad Soyad`,className:`w-full pl-10 p-3 border-2 rounded-xl outline-none transition-colors ${W.cardName&&H.cardName?`border-red-300 focus:border-red-500`:`border-slate-200 focus:border-purple-500`}`,value:M,onChange:e=>N(e.target.value),onBlur:()=>Z(`cardName`)}),W.cardName&&H.cardName&&(0,y.jsxs)(`div`,{className:`flex items-center gap-2 mt-2 text-red-600 text-sm`,children:[(0,y.jsx)(r,{size:16}),(0,y.jsx)(`span`,{children:H.cardName})]})]})]}),(0,y.jsxs)(`div`,{className:`flex gap-4 mb-10 cursor-pointer`,onClick:()=>Y(`form_spacing`,`Form elementləri arasında boşluq qeyri-bərabərdir`),children:[(0,y.jsxs)(`div`,{className:`flex-1`,children:[(0,y.jsx)(`label`,{className:`block text-sm font-bold text-slate-700 mb-2`,children:`Bitmə Tarixi`}),(0,y.jsxs)(`div`,{className:`relative`,children:[(0,y.jsx)(t,{className:`absolute left-3 top-3.5 text-slate-400`,size:18}),(0,y.jsx)(`input`,{type:`month`,className:`w-full pl-10 p-3 border-2 rounded-xl outline-none transition-colors ${W.expiry&&H.expiry?`border-red-300 focus:border-red-500`:`border-slate-200 focus:border-purple-500`}`,value:P,onChange:e=>F(e.target.value),onBlur:()=>Z(`expiry`)}),W.expiry&&H.expiry&&(0,y.jsxs)(`div`,{className:`flex items-center gap-2 mt-2 text-red-600 text-sm`,children:[(0,y.jsx)(r,{size:16}),(0,y.jsx)(`span`,{children:H.expiry})]})]})]}),(0,y.jsxs)(`div`,{className:`flex-1`,children:[(0,y.jsx)(`label`,{className:`block text-sm font-bold text-slate-700 mb-2`,children:`CVV`}),(0,y.jsxs)(`div`,{className:`relative`,children:[(0,y.jsx)(f,{className:`absolute left-3 top-3.5 text-slate-400`,size:18}),(0,y.jsx)(`input`,{type:`text`,placeholder:`123`,className:`w-full pl-10 p-3 border-2 rounded-xl outline-none transition-colors ${W.cvv&&H.cvv?`border-red-300 focus:border-red-500`:`border-slate-200 focus:border-purple-500`}`,value:I,onChange:e=>{L(e.target.value),e.target.value.length>0&&!p.includes(`cvv_visible`)&&h(`cvv_visible`)},onBlur:()=>Z(`cvv`)}),W.cvv&&H.cvv&&(0,y.jsxs)(`div`,{className:`flex items-center gap-2 mt-2 text-red-600 text-sm`,children:[(0,y.jsx)(r,{size:16}),(0,y.jsx)(`span`,{children:H.cvv})]})]})]})]}),(0,y.jsxs)(`div`,{className:`bg-slate-50 p-4 rounded-xl space-y-2`,children:[(0,y.jsxs)(`div`,{className:`flex justify-between text-sm text-slate-600`,children:[(0,y.jsx)(`span`,{children:`Məbləğ:`}),(0,y.jsx)(`span`,{children:`100 AZN`})]}),(0,y.jsxs)(`div`,{className:`flex justify-between text-sm text-slate-600`,children:[(0,y.jsx)(`span`,{children:`Komissiya:`}),(0,y.jsx)(`span`,{children:`5 AZN`})]}),(0,y.jsxs)(`div`,{className:`border-t border-slate-200 pt-2 flex justify-between font-bold text-slate-900`,children:[(0,y.jsx)(`span`,{className:`text-slate-300 cursor-pointer`,onClick:()=>Y(`amount_label`,`Məbləğ yazısında rəng kontrastı zəifdir`),children:`Cəmi:`}),(0,y.jsx)(`span`,{className:`text-red-500`,children:`1005 AZN`})]})]}),(0,y.jsx)(`button`,{type:`submit`,disabled:B,className:`w-full py-4 bg-purple-600 text-white rounded-xl font-bold shadow-lg shadow-purple-200 hover:bg-purple-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2`,children:B?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(d,{className:`animate-spin`,size:20}),(0,y.jsx)(`span`,{children:`Emal edilir...`})]}):`Ödəni et`})]})]}),(0,y.jsx)(c,{bugs:G,foundBugs:p,onReset:b,xp:S,getBugPoints:C,getBugDifficulty:x,deductXP:se}),(0,y.jsx)(s,{isOpen:ue,onClose:()=>K(!1),onSubmit:de,bug:G.find(e=>e.id===q)})]})}export{b as default};