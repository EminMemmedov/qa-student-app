import"./useTranslation-CZ9xHxJN.js";import{t as e}from"./arrow-left-ClyJ6XUf.js";import{t}from"./calendar-Bel4mc-r.js";import{t as n}from"./circle-alert-Bewc_LJ2.js";import"./circle-check-big-B22zqBBM.js";import{a as r,i,n as a,o,r as s,t as c}from"./practiceSpecs-DMcTf_HM.js";import{t as l}from"./credit-card-DVDMGfjs.js";import{t as ee}from"./file-text-HnNb_H9_.js";import{t as u}from"./search-D7VMKGnQ.js";import{t as d}from"./loader-circle-BOmLiqlA.js";import{t as f}from"./lock-CTSjm3IG.js";import"./sparkles-OBPY9Zgb.js";import"./terminal-BOUmEsGu.js";import{t as p}from"./user-CV3heKPA.js";import{E as m,S as h,i as te,j as g,n as ne,s as re,t as ie}from"./index-L6i9Tykn.js";import{t as ae}from"./useGameProgress-DJOXUuUo.js";import"./confetti.module-BcdpeI79.js";import{t as oe}from"./PageTransition-BxzcKw6d.js";import{t as se}from"./bugs-CuwXSAyT.js";import{t as _}from"./logger-z-UmzD0Z.js";import{n as v}from"./confetti-Bp_qY1CC.js";var y=g(),b=h();function x(){let{foundBugs:h,addBug:g,resetProgress:x,getBugDifficulty:S,xp:ce,getBugPoints:C,deductXP:w}=ae(),{newAchievement:T,checkAchievements:E}=ne(),{showAnimation:le,animationData:D,triggerBugAnimation:O}=s(),{addLog:k,addRequest:A}=ie(),[j,M]=(0,y.useState)(``),[N,P]=(0,y.useState)(``),[F,I]=(0,y.useState)(``),[L,R]=(0,y.useState)(``),[z,B]=(0,y.useState)(!1),[V,H]=(0,y.useState)(!1),[U,ue]=(0,y.useState)({}),[W,de]=(0,y.useState)({}),G=se(`payment`),[fe,K]=(0,y.useState)(!1),[q,J]=(0,y.useState)(null),Y=e=>{h.includes(e)||(J(e),K(!0))},X=e=>{let t=g(e);if(t.isNew){let n=G.find(t=>t.id===e);O({...t,bugName:n.description}),E({foundBugs:[...h,e],totalBugs:G.length,moduleBugs:{payment:G},getBugDifficulty:S})}},pe=({severity:e,priority:t})=>{let n=G.find(e=>e.id===q),r=0;e===n.severity&&(r+=5),t===n.priority&&(r+=5);let i=C(S(q))+r;g(q),O({isNew:!0,points:i,bugName:n.description}),K(!1),J(null),E({foundBugs:[...h,q],totalBugs:G.length,moduleBugs:{payment:G},getBugDifficulty:S})},me=()=>{let e={},t=[];if(j?(j.length>16&&(t.push(`card_len`),e.cardNumber=`Kart nömrəsi 16 rəqəmdən çox ola bilməz`),/[a-zA-Z]/.test(j)&&(t.push(`card_char`),e.cardNumber=`Kart nömrəsi yalnız rəqəmlərdən ibarət olmalıdır`),/[^0-9]/.test(j)&&(t.push(`card_special`),e.cardNumber=`Kart nömrəsində xüsusi simvollar ola bilməz`)):e.cardNumber=`Kart nömrəsi tələb olunur`,N?(/[0-9]/.test(N)&&(t.push(`name_numbers`),e.cardName=`Ad sahəsində rəqəmlər ola bilməz`),N.length>0&&N.length<2&&(t.push(`name_short`),e.cardName=`Ad ən azı 2 simvol olmalıdır`)):e.cardName=`Kart sahibinin adı tələb olunur`,!F)e.expiry=`Bitmə tarixi tələb olunur`;else{let n=new Date(F),r=new Date;n<r&&(t.push(`expiry_past`),e.expiry=`Keçmiş tarix seçilə bilməz`);let i=r.getMonth(),a=r.getFullYear(),o=n.getMonth();n.getFullYear()===a&&o===i&&(t.push(`expiry_current`),e.expiry=`Cari ay artıq bitib, gələcək ay seçin`)}return L?(L.length>3&&(t.push(`cvv_len`),e.cvv=`CVV 3 rəqəmdən çox ola bilməz`),/[a-zA-Z]/.test(L)&&(t.push(`cvv_letters`),e.cvv=`CVV yalnız rəqəmlərdən ibarət olmalıdır`)):e.cvv=`CVV kodu tələb olunur`,t.push(`btn_typo`),t.push(`total_wrong`),t.push(`loading_state`),t.push(`success_msg`),ue(e),{isValid:Object.keys(e).length===0,detectedBugs:t}},he=async()=>{if(V){X(`btn_double`);return}let{isValid:e,detectedBugs:t}=me(),n=!1;if(t.forEach(e=>{X(e),h.includes(e)||(n=!0)}),!e){Object.values(U)[0];return}H(!0),k(`info`,`Starting payment processing...`,{amount:100,currency:`AZN`}),await new Promise(e=>setTimeout(e,1500)),H(!1),A(`POST`,`https://api.bank.com/v1/payments`,500,1500,{error:`Internal Server Error`}),k(`error`,`Payment failed: Server responded with status 500`),n||_.log(`Payment processed (but no message shown to user)`)},Z=e=>{de({...W,[e]:!0})},Q=G,$=h.filter(e=>Q.some(t=>t.id===e));return(0,y.useEffect)(()=>{$.length===Q.length&&Q.length>0&&v()},[$.length,Q.length]),(0,b.jsxs)(oe,{className:`p-6 pt-12 pb-24 min-h-screen`,children:[(0,b.jsx)(r,{isOpen:z,onClose:()=>B(!1),spec:c.payment}),(0,b.jsx)(re,{children:le&&D&&(0,b.jsx)(i,{bugName:D.bugName,points:D.points,onComplete:()=>{}})}),T&&(0,b.jsx)(te,{achievement:T,onClose:()=>{}}),(0,b.jsxs)(`header`,{className:`mb-8`,children:[(0,b.jsxs)(m,{to:`/practice`,className:`inline-flex items-center text-slate-500 mb-4 hover:text-slate-800 transition-colors`,children:[(0,b.jsx)(e,{size:20,className:`mr-1`}),`Geri qayıt`]}),(0,b.jsxs)(`div`,{className:`flex justify-between items-start`,children:[(0,b.jsxs)(`div`,{children:[(0,b.jsx)(`h1`,{className:`text-3xl font-black text-slate-900 tracking-tight mb-2`,children:`Ödəniş Səhifəsi`}),(0,b.jsxs)(`div`,{className:`flex items-center gap-2 text-slate-500 font-medium`,children:[(0,b.jsx)(u,{size:18}),(0,b.jsxs)(`p`,{children:[`Bu səhifədə `,G.length,` baq gizlənib.`]})]})]}),(0,b.jsx)(`button`,{onClick:()=>B(!0),className:`p-3 bg-indigo-100 text-indigo-600 rounded-xl hover:bg-indigo-200 transition-colors`,children:(0,b.jsx)(ee,{size:24})})]})]}),(0,b.jsxs)(`div`,{className:`bg-white p-8 rounded-[2rem] shadow-xl shadow-purple-200/50 border border-slate-100 relative overflow-hidden mb-8`,children:[(0,b.jsx)(`div`,{className:`absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-purple-500 to-pink-500`}),(0,b.jsxs)(`form`,{onSubmit:e=>{e.preventDefault(),he()},className:`space-y-6`,children:[(0,b.jsxs)(`div`,{className:`mb-8`,children:[(0,b.jsx)(`label`,{className:`block text-sm font-bold text-slate-700 mb-2`,children:`Kart Nömrəsi`}),(0,b.jsxs)(`div`,{className:`relative`,children:[(0,b.jsx)(l,{className:`absolute left-3 top-3.5 text-green-400 cursor-pointer`,size:18,onClick:()=>Y(`card_icon`,`Kart ikonası yanlış rəngdədir (qırmızı əvəzinə yaşıl)`)}),(0,b.jsx)(`input`,{type:`text`,placeholder:`0000 0000 0000 0000`,className:`w - full pl - 10 p - 3 border - 2 rounded - xl outline - none transition - colors ${W.cardNumber&&U.cardNumber?`border-red-300 focus:border-red-500`:`border-slate-200 focus:border-green-500`} `,value:j,onChange:e=>M(e.target.value),onBlur:()=>Z(`cardNumber`),onClick:()=>Y(`border_color`,`Focus zamanı border rəngi səhvdir`)}),W.cardNumber&&U.cardNumber&&(0,b.jsxs)(`div`,{className:`flex items-center gap-2 mt-2 text-red-600 text-sm`,children:[(0,b.jsx)(n,{size:16}),(0,b.jsx)(`span`,{children:U.cardNumber})]})]})]}),(0,b.jsxs)(`div`,{className:`mb-3`,children:[(0,b.jsx)(`label`,{className:`block text-sm font-bold text-slate-700 mb-2 cursor-pointer`,onClick:()=>Y(`name_label`,`Ad sahəsində label səhvi: "Kart sahibi" əvəzinə "Kart sahbi"`),children:`Kart sahbi`}),(0,b.jsxs)(`div`,{className:`relative`,children:[(0,b.jsx)(p,{className:`absolute left-3 top-3.5 text-slate-400`,size:18}),(0,b.jsx)(`input`,{type:`text`,placeholder:`Ad Soyad`,className:`w - full pl - 10 p - 3 border - 2 rounded - xl outline - none transition - colors ${W.cardName&&U.cardName?`border-red-300 focus:border-red-500`:`border-slate-200 focus:border-purple-500`} `,value:N,onChange:e=>P(e.target.value),onBlur:()=>Z(`cardName`)}),W.cardName&&U.cardName&&(0,b.jsxs)(`div`,{className:`flex items-center gap-2 mt-2 text-red-600 text-sm`,children:[(0,b.jsx)(n,{size:16}),(0,b.jsx)(`span`,{children:U.cardName})]})]})]}),(0,b.jsxs)(`div`,{className:`flex gap-4 mb-10 cursor-pointer`,onClick:()=>Y(`form_spacing`,`Form elementləri arasında boşluq qeyri-bərabərdir`),children:[(0,b.jsxs)(`div`,{className:`flex-1`,children:[(0,b.jsx)(`label`,{className:`block text-sm font-bold text-slate-700 mb-2`,children:`Bitmə Tarixi`}),(0,b.jsxs)(`div`,{className:`relative`,children:[(0,b.jsx)(t,{className:`absolute left-3 top-3.5 text-slate-400`,size:18}),(0,b.jsx)(`input`,{type:`month`,className:`w - full pl - 10 p - 3 border - 2 rounded - xl outline - none transition - colors ${W.expiry&&U.expiry?`border-red-300 focus:border-red-500`:`border-slate-200 focus:border-purple-500`} `,value:F,onChange:e=>I(e.target.value),onBlur:()=>Z(`expiry`)}),W.expiry&&U.expiry&&(0,b.jsxs)(`div`,{className:`flex items-center gap-2 mt-2 text-red-600 text-sm`,children:[(0,b.jsx)(n,{size:16}),(0,b.jsx)(`span`,{children:U.expiry})]})]})]}),(0,b.jsxs)(`div`,{className:`flex-1`,children:[(0,b.jsx)(`label`,{className:`block text-sm font-bold text-slate-700 mb-2`,children:`CVV`}),(0,b.jsxs)(`div`,{className:`relative`,children:[(0,b.jsx)(f,{className:`absolute left-3 top-3.5 text-slate-400`,size:18}),(0,b.jsx)(`input`,{type:`text`,placeholder:`123`,className:`w - full pl - 10 p - 3 border - 2 rounded - xl outline - none transition - colors ${W.cvv&&U.cvv?`border-red-300 focus:border-red-500`:`border-slate-200 focus:border-purple-500`} `,value:L,onChange:e=>{R(e.target.value),e.target.value.length>0&&!h.includes(`cvv_visible`)&&g(`cvv_visible`)},onBlur:()=>Z(`cvv`)}),W.cvv&&U.cvv&&(0,b.jsxs)(`div`,{className:`flex items-center gap-2 mt-2 text-red-600 text-sm`,children:[(0,b.jsx)(n,{size:16}),(0,b.jsx)(`span`,{children:U.cvv})]})]})]})]}),(0,b.jsxs)(`div`,{className:`bg-slate-50 p-4 rounded-xl space-y-2`,children:[(0,b.jsxs)(`div`,{className:`flex justify-between text-sm text-slate-600`,children:[(0,b.jsx)(`span`,{children:`Məbləğ:`}),(0,b.jsx)(`span`,{children:`100 AZN`})]}),(0,b.jsxs)(`div`,{className:`flex justify-between text-sm text-slate-600`,children:[(0,b.jsx)(`span`,{children:`Komissiya:`}),(0,b.jsx)(`span`,{children:`5 AZN`})]}),(0,b.jsxs)(`div`,{className:`border-t border-slate-200 pt-2 flex justify-between font-bold text-slate-900`,children:[(0,b.jsx)(`span`,{className:`text-slate-300 cursor-pointer`,onClick:()=>Y(`amount_label`,`Məbləğ yazısında rəng kontrastı zəifdir`),children:`Cəmi:`}),(0,b.jsx)(`span`,{className:`text-red-500`,children:`1005 AZN`})]})]}),(0,b.jsx)(`button`,{type:`submit`,disabled:V,className:`w-full py-4 bg-purple-600 text-white rounded-xl font-bold shadow-lg shadow-purple-200 hover:bg-purple-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2`,children:V?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d,{className:`animate-spin`,size:20}),(0,b.jsx)(`span`,{children:`Emal edilir...`})]}):`Ödəni et`})]})]}),(0,b.jsx)(o,{bugs:G,foundBugs:h,onReset:x,xp:ce,getBugPoints:C,getBugDifficulty:S,deductXP:w}),(0,b.jsx)(a,{isOpen:fe,onClose:()=>K(!1),onSubmit:pe,bug:G.find(e=>e.id===q)})]})}export{x as default};