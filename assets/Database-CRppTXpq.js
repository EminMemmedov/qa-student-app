import{t as e}from"./useTranslation-BCVn0i94.js";import{t}from"./chevron-left-BqAmS5KW.js";import{t as n}from"./circle-alert-DCkrH_Hy.js";import{t as r}from"./circle-check-big-DdajXeVL.js";import{t as i}from"./database-BY7RipFH.js";import{n as a,t as o}from"./play-t_sjRfiQ.js";import{t as s}from"./lock-open-CpyXHZr_.js";import{t as c}from"./lock-OV_bJMSf.js";import{t as l}from"./refresh-cw-CfJTcbLs.js";import{t as u}from"./rotate-ccw-CLqqZRoZ.js";import{t as d}from"./terminal-ayPH-SQE.js";import{t as f}from"./trash-2-BziU93Zb.js";import{b as p,g as m,n as h,p as g,w as _}from"./index-DafDo4Gr.js";import{t as v}from"./useGameProgress-CjIEHxQx.js";import{t as y}from"./confetti.module-DMN0QfNx.js";import{t as b}from"./PageTransition-Dt5AKVBJ.js";var x=g(`table`,[[`path`,{d:`M12 3v18`,key:`108xh3`}],[`rect`,{width:`18`,height:`18`,x:`3`,y:`3`,rx:`2`,key:`afitv7`}],[`path`,{d:`M3 9h18`,key:`1pudct`}],[`path`,{d:`M3 15h18`,key:`5xshup`}]]),S=_(),C=m(),w={users:[{id:1,username:`admin`,email:`admin@example.com`,status:`active`,role:`admin`},{id:2,username:`john_doe`,email:`john@test.com`,status:`active`,role:`user`},{id:3,username:`jane_smith`,email:`jane@test.com`,status:`inactive`,role:`user`},{id:4,username:`hacker_1337`,email:`x@hacked.com`,status:`banned`,role:`user`},{id:5,username:`guest`,email:`guest@temp.mail`,status:`active`,role:`guest`}],orders:[{id:101,user_id:2,amount:50,status:`completed`},{id:102,user_id:2,amount:120.5,status:`pending`},{id:103,user_id:3,amount:15,status:`cancelled`}]};function T(){let{t:m}=e(),{addXP:g,xp:_}=v(),{checkAchievements:T}=h(),[E,D]=(0,S.useState)(1),[O,k]=(0,S.useState)({}),[A,j]=(0,S.useState)(``),[M,N]=(0,S.useState)(!1),[P,F]=(0,S.useState)([]),[I,L]=(0,S.useState)(-1),[R,z]=(0,S.useState)(null),[B,V]=(0,S.useState)(()=>{let e=localStorage.getItem(`qa_database_completed`);return e?JSON.parse(e):[]}),H=(0,S.useRef)(null);(0,S.useEffect)(()=>{localStorage.setItem(`qa_database_completed`,JSON.stringify(B))},[B]);let U={1:{id:1,task:m(`database.levels.level1_task`),expected:e=>e.users,validate:e=>e.length===5&&e[0].username,hint:`İstifadəçilər cədvəlindən bütün məlumatları seçmək üçün hansı açar söz lazımdır? (SELECT ... FROM ...)`,answer:`SELECT * FROM users`},2:{id:2,task:m(`database.levels.level2_task`),expected:e=>e.users.filter(e=>e.status===`active`),validate:e=>e.length===3&&e.every(e=>e.status===`active`),hint:`Şərt vermək üçün WHERE istifadə et. status = 'active'`,answer:`SELECT * FROM users WHERE status = 'active'`},3:{id:3,task:m(`database.levels.level3_task`),expected:e=>e.users.map(e=>({username:e.username,email:e.email})),validate:e=>e.length>0&&Object.keys(e[0]).length===2&&e[0].username&&e[0].email&&!e[0].id,hint:`SELECT * əvəzinə konkret sütun adlarını yazın (vergüllə ayıraraq).`,answer:`SELECT username, email FROM users`},4:{id:4,task:m(`database.levels.level4_task`),expected:e=>[...e.users].sort((e,t)=>t.id-e.id),validate:e=>e.length===5&&e[0].id===5,hint:`Sıralamaq üçün ORDER BY ... DESC istifadə edin.`,answer:`SELECT * FROM users ORDER BY id DESC`},5:{id:5,task:m(`database.levels.level5_task`),expected:e=>e.users,validate:(e,t)=>e.length===5&&(t.toLowerCase().includes(`or 1=1`)||t.toLowerCase().includes(`or true`)),hint:`WHERE şərtində elə bir ifadə yaz ki, həmişə doğru (TRUE) olsun. Məsələn: OR 1=1`,answer:`SELECT * FROM users WHERE username = 'admin' OR 1=1`}}[E];(0,S.useEffect)(()=>{j(O[E]||``),N(!1),z(null)},[E]);let W=e=>{j(e),k(t=>({...t,[E]:e}))},G=()=>{N(!0),W(U.answer)},K=e=>{let t=e.trim();if(!t)return;let n=t.toLowerCase();F(e=>[...e,t]),L(-1);try{if(!n.startsWith(`select`))throw Error(`Only SELECT queries are supported in this terminal.`);let e=[...w.users],r=Object.keys(w.users[0]),i=n.match(/from\s+(\w+)/);if(!i)throw Error(`Syntax Error: Missing FROM clause.`);let a=i[1];if(!w[a])throw Error(`Table '${a}' not found.`);if(e=[...w[a]],r=Object.keys(e[0]),n.includes(`where`)){let r=t.substring(n.indexOf(`where`)+5).split(/order by/i)[0].trim();if(!(E===5&&(r.includes(`OR 1=1`)||r.includes(`OR true`)))){let t=r.match(/(\w+)\s*(=|!=|>|<)\s*['"]?([^'"]+)['"]?/);if(t){let[n,r,i,a]=t;e=e.filter(e=>{let t=e[r],n=isNaN(a)?a:Number(a);switch(i){case`=`:return t==n;case`!=`:return t!=n;case`>`:return t>n;case`<`:return t<n;default:return!1}})}}}let o=t.substring(6,n.indexOf(`from`)).trim();if(o!==`*`){let t=o.split(`,`).map(e=>e.trim()),n=t.find(e=>!r.includes(e));if(n)throw Error(`Column '${n}' not found in '${a}'.`);e=e.map(e=>{let n={};return t.forEach(t=>n[t]=e[t]),n}),r=t}if(n.includes(`order by`)){let[t,i]=n.split(`order by`)[1].trim().split(/\s+/);t&&r.includes(t)&&e.sort((e,n)=>i===`desc`?n[t]>e[t]?1:-1:e[t]>n[t]?1:-1)}let s=U.validate(e,t);z({columns:r,rows:e,success:s,error:null}),s&&!B.includes(E)?q():s&&y({particleCount:50,spread:50,origin:{y:.7}})}catch(e){z({columns:[],rows:[],success:!1,error:e.message})}},q=()=>{y({particleCount:150,spread:70,origin:{y:.6}});let e=[...B,E];V(e);let t=M?0:300;t>0&&g(t),T({xp:_+t,completedLevels:{database:e},addXP:g,foundBugs:[],moduleBugs:{},getBugDifficulty:()=>`medium`})};return(0,C.jsx)(b,{className:`min-h-screen bg-slate-900 text-slate-300 p-6 pt-20 pb-24`,children:(0,C.jsxs)(`div`,{className:`max-w-7xl mx-auto`,children:[(0,C.jsxs)(`div`,{className:`flex items-center justify-between mb-8`,children:[(0,C.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,C.jsx)(p,{to:`/practice`,className:`p-2 bg-slate-800 rounded-xl hover:bg-slate-700 transition-colors`,children:(0,C.jsx)(t,{className:`text-white`})}),(0,C.jsxs)(`div`,{children:[(0,C.jsxs)(`h1`,{className:`text-3xl font-bold text-white flex items-center gap-3`,children:[(0,C.jsx)(i,{size:32,className:`text-indigo-500`}),m(`database.title`)]}),(0,C.jsx)(`p`,{className:`text-slate-400`,children:m(`database.description`)})]})]}),(0,C.jsx)(`button`,{onClick:()=>{window.confirm(m(`common.reset_confirm`)||`Are you sure you want to reset progress?`)&&(V([]),D(1),k({}),F([]),z(null))},className:`p-2 text-slate-500 hover:text-red-400 transition-colors`,title:`Reset Progress`,children:(0,C.jsx)(f,{size:20})})]}),(0,C.jsx)(`div`,{className:`flex gap-4 mb-8 overflow-x-auto pb-2`,children:[1,2,3,4,5].map(e=>{let t=e>1&&!B.includes(e-1),n=B.includes(e);return(0,C.jsx)(`button`,{onClick:()=>!t&&D(e),disabled:t,className:`flex-1 min-w-[150px] p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ${E===e?`border-indigo-500 bg-indigo-500/10 text-white`:t?`border-slate-800 bg-slate-800/50 text-slate-600 cursor-not-allowed`:`border-slate-700 bg-slate-800 text-slate-400 hover:border-slate-600`}`,children:(0,C.jsxs)(`div`,{className:`flex items-center gap-2`,children:[t?(0,C.jsx)(c,{size:16}):n?(0,C.jsx)(r,{size:16,className:`text-green-500`}):(0,C.jsx)(s,{size:16}),(0,C.jsx)(`span`,{className:`font-bold text-sm`,children:m(`database.levels.level${e}`)})]})},e)})}),(0,C.jsxs)(`div`,{className:`flex flex-col lg:grid lg:grid-cols-3 gap-6 min-h-[600px]`,children:[(0,C.jsxs)(`div`,{className:`lg:col-span-1 flex flex-col gap-6 order-2 lg:order-1`,children:[(0,C.jsxs)(`div`,{className:`bg-slate-800 rounded-2xl p-6 border border-slate-700 shadow-xl`,children:[(0,C.jsxs)(`div`,{className:`flex items-center gap-2 mb-4`,children:[(0,C.jsx)(d,{className:`text-indigo-400`}),(0,C.jsx)(`h2`,{className:`text-xl font-bold text-white`,children:m(`database.task`)})]}),(0,C.jsx)(`p`,{className:`text-lg text-slate-200 font-medium mb-4`,children:U.task}),(0,C.jsxs)(`div`,{className:`bg-slate-900/50 p-4 rounded-xl border border-slate-700 text-sm text-slate-400 mb-4`,children:[(0,C.jsxs)(`p`,{className:`font-bold text-slate-500 mb-1`,children:[m(`database.hint`),`:`]}),U.hint]}),(0,C.jsxs)(`div`,{className:`flex gap-2`,children:[(0,C.jsxs)(`button`,{onClick:()=>W(``),className:`flex-1 py-2 px-3 rounded-lg bg-slate-700 hover:bg-slate-600 text-white text-sm font-bold flex items-center justify-center gap-2 transition-colors`,children:[(0,C.jsx)(u,{size:14}),`Sıfırla`]}),(0,C.jsxs)(`button`,{onClick:G,disabled:M,className:`flex-1 py-2 px-3 rounded-lg border text-sm font-bold flex items-center justify-center gap-2 transition-colors ${M?`bg-slate-800 border-slate-700 text-slate-500 cursor-not-allowed`:`bg-indigo-900/50 hover:bg-indigo-900 border-indigo-500/30 text-indigo-300`}`,children:[(0,C.jsx)(a,{size:14}),M?`Göstərilib`:`Cavab`]})]}),M&&(0,C.jsx)(`div`,{className:`mt-2 text-xs text-amber-500 text-center font-bold`,children:`Cavaba baxdığınız üçün XP verilməyəcək!`})]}),(0,C.jsxs)(`div`,{className:`bg-slate-800 rounded-2xl p-6 border border-slate-700 shadow-xl flex-1 overflow-y-auto max-h-[300px] lg:max-h-none`,children:[(0,C.jsxs)(`div`,{className:`flex items-center gap-2 mb-4`,children:[(0,C.jsx)(x,{className:`text-emerald-400`}),(0,C.jsx)(`h2`,{className:`text-xl font-bold text-white`,children:m(`database.tables`)})]}),(0,C.jsxs)(`div`,{className:`mb-6`,children:[(0,C.jsx)(`h3`,{className:`text-sm font-bold text-slate-400 mb-2 uppercase tracking-wider`,children:`Users Table`}),(0,C.jsxs)(`div`,{className:`bg-slate-900 rounded-xl overflow-hidden border border-slate-700`,children:[(0,C.jsxs)(`div`,{className:`grid grid-cols-2 bg-slate-950 p-2 text-xs font-bold text-slate-500`,children:[(0,C.jsx)(`div`,{children:`Column`}),(0,C.jsx)(`div`,{children:`Type`})]}),(0,C.jsxs)(`div`,{className:`divide-y divide-slate-800 text-sm`,children:[(0,C.jsxs)(`div`,{className:`grid grid-cols-2 p-2 hover:bg-slate-800/50`,children:[(0,C.jsx)(`span`,{className:`font-mono text-indigo-300`,children:`id`}),(0,C.jsx)(`span`,{className:`text-slate-500`,children:`INT (PK)`})]}),(0,C.jsxs)(`div`,{className:`grid grid-cols-2 p-2 hover:bg-slate-800/50`,children:[(0,C.jsx)(`span`,{className:`font-mono text-indigo-300`,children:`username`}),(0,C.jsx)(`span`,{className:`text-slate-500`,children:`VARCHAR`})]}),(0,C.jsxs)(`div`,{className:`grid grid-cols-2 p-2 hover:bg-slate-800/50`,children:[(0,C.jsx)(`span`,{className:`font-mono text-indigo-300`,children:`email`}),(0,C.jsx)(`span`,{className:`text-slate-500`,children:`VARCHAR`})]}),(0,C.jsxs)(`div`,{className:`grid grid-cols-2 p-2 hover:bg-slate-800/50`,children:[(0,C.jsx)(`span`,{className:`font-mono text-indigo-300`,children:`status`}),(0,C.jsx)(`span`,{className:`text-slate-500`,children:`ENUM`})]}),(0,C.jsxs)(`div`,{className:`grid grid-cols-2 p-2 hover:bg-slate-800/50`,children:[(0,C.jsx)(`span`,{className:`font-mono text-indigo-300`,children:`role`}),(0,C.jsx)(`span`,{className:`text-slate-500`,children:`ENUM`})]})]})]})]})]})]}),(0,C.jsxs)(`div`,{className:`lg:col-span-2 flex flex-col gap-4 order-1 lg:order-2`,children:[(0,C.jsxs)(`div`,{className:`bg-slate-900 rounded-2xl border border-slate-700 shadow-2xl flex flex-col overflow-hidden`,children:[(0,C.jsxs)(`div`,{className:`bg-slate-950 px-4 py-2 flex items-center justify-between border-b border-slate-800`,children:[(0,C.jsxs)(`div`,{className:`flex gap-2`,children:[(0,C.jsx)(`div`,{className:`w-3 h-3 rounded-full bg-red-500/20 border border-red-500/50`}),(0,C.jsx)(`div`,{className:`w-3 h-3 rounded-full bg-yellow-500/20 border border-yellow-500/50`}),(0,C.jsx)(`div`,{className:`w-3 h-3 rounded-full bg-green-500/20 border border-green-500/50`})]}),(0,C.jsx)(`span`,{className:`text-xs font-mono text-slate-500`,children:`mysql-client — v8.0`})]}),(0,C.jsxs)(`div`,{className:`p-4 flex-1 relative min-h-[150px]`,children:[(0,C.jsx)(`textarea`,{ref:H,value:A,onChange:e=>W(e.target.value),onKeyDown:e=>{if(e.key===`Enter`&&!e.shiftKey&&(e.preventDefault(),K(A)),e.key===`ArrowUp`&&(e.preventDefault(),I<P.length-1)){let e=I+1;L(e),W(P[P.length-1-e])}if(e.key===`ArrowDown`)if(e.preventDefault(),I>0){let e=I-1;L(e),W(P[P.length-1-e])}else L(-1),W(``)},placeholder:m(`database.terminal_placeholder`),className:`w-full h-full bg-transparent font-mono text-base text-emerald-400 placeholder:text-slate-700 focus:outline-none resize-none pb-12`,spellCheck:`false`}),(0,C.jsxs)(`div`,{className:`absolute bottom-4 right-4 flex gap-2`,children:[(0,C.jsx)(`button`,{onClick:()=>W(``),className:`p-2 rounded-lg bg-slate-800 text-slate-400 hover:bg-slate-700 hover:text-white transition-colors`,title:m(`database.clear`),children:(0,C.jsx)(l,{size:16})}),(0,C.jsxs)(`button`,{onClick:()=>K(A),className:`px-4 py-2 rounded-lg bg-indigo-600 text-white font-bold hover:bg-indigo-500 transition-colors flex items-center gap-2 shadow-lg shadow-indigo-500/20`,children:[(0,C.jsx)(o,{size:16,fill:`currentColor`}),m(`database.execute`)]})]})]})]}),(0,C.jsxs)(`div`,{className:`flex-1 bg-slate-800 rounded-2xl border border-slate-700 shadow-xl overflow-hidden flex flex-col min-h-[200px]`,children:[(0,C.jsxs)(`div`,{className:`px-4 py-3 bg-slate-950 border-b border-slate-800 flex justify-between items-center`,children:[(0,C.jsx)(`span`,{className:`font-bold text-slate-400 text-sm uppercase tracking-wider`,children:m(`database.result`)}),R?.success&&(0,C.jsxs)(`span`,{className:`bg-green-500/10 text-green-400 px-3 py-1 rounded-full text-xs font-bold flex items-center gap-1`,children:[(0,C.jsx)(r,{size:12}),m(`database.success`)]})]}),(0,C.jsx)(`div`,{className:`flex-1 overflow-x-auto p-0`,children:R?.error?(0,C.jsxs)(`div`,{className:`p-8 flex flex-col items-center justify-center text-center h-full text-red-400`,children:[(0,C.jsx)(n,{size:48,className:`mb-4 opacity-50`}),(0,C.jsx)(`h3`,{className:`text-lg font-bold mb-2`,children:m(`database.error`)}),(0,C.jsx)(`p`,{className:`font-mono bg-red-950/30 px-4 py-2 rounded-lg border border-red-900/50`,children:R.error})]}):R?.rows?.length>0?(0,C.jsxs)(`div`,{className:`min-w-[500px]`,children:[` `,(0,C.jsxs)(`table`,{className:`w-full text-left border-collapse`,children:[(0,C.jsx)(`thead`,{className:`bg-slate-900/50 text-xs uppercase font-bold text-slate-500 sticky top-0`,children:(0,C.jsx)(`tr`,{children:R.columns.map(e=>(0,C.jsx)(`th`,{className:`p-4 border-b border-slate-700`,children:e},e))})}),(0,C.jsx)(`tbody`,{className:`divide-y divide-slate-700/50 font-mono text-sm text-slate-300`,children:R.rows.map((e,t)=>(0,C.jsx)(`tr`,{className:`hover:bg-slate-700/30 transition-colors`,children:R.columns.map(t=>(0,C.jsx)(`td`,{className:`p-4`,children:e[t]},t))},t))})]})]}):(0,C.jsxs)(`div`,{className:`h-full flex flex-col items-center justify-center text-slate-600 p-8`,children:[(0,C.jsx)(x,{size:48,className:`mb-4 opacity-20`}),(0,C.jsx)(`p`,{className:`text-center text-sm`,children:m(`database.terminal_placeholder`)})]})})]})]})]})]})})}export{T as default};