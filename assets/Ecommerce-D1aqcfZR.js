import"./useTranslation-CZ9xHxJN.js";import{t as e}from"./arrow-left-ClyJ6XUf.js";import{t}from"./circle-alert-Bewc_LJ2.js";import"./circle-check-big-B22zqBBM.js";import{a as n,i as r,n as i,o as a,r as o,s as ee,t as s}from"./practiceSpecs-DMcTf_HM.js";import{t as c}from"./file-text-HnNb_H9_.js";import{t as te}from"./info-BeibuglM.js";import{t as ne}from"./search-D7VMKGnQ.js";import{t as l}from"./loader-circle-BOmLiqlA.js";import{t as u}from"./plus-CL8yHCAR.js";import"./sparkles-OBPY9Zgb.js";import"./terminal-BOUmEsGu.js";import{t as d}from"./trash-2-EorY0dL0.js";import{E as f,S as p,i as m,j as h,n as re,s as ie,t as ae,y as g}from"./index-L6i9Tykn.js";import{t as oe}from"./useGameProgress-DJOXUuUo.js";import"./confetti.module-BcdpeI79.js";import{t as se}from"./PageTransition-BxzcKw6d.js";import{n as ce}from"./confetti-Bp_qY1CC.js";var le=g(`minus`,[[`path`,{d:`M5 12h14`,key:`1ays0h`}]]),ue=g(`package`,[[`path`,{d:`M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z`,key:`1a0edw`}],[`path`,{d:`M12 22V12`,key:`d0xqtd`}],[`polyline`,{points:`3.29 7 12 12 20.71 7`,key:`ousv84`}],[`path`,{d:`m7.5 4.27 9 5.15`,key:`1c824w`}]]),de=g(`tag`,[[`path`,{d:`M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z`,key:`vktsd0`}],[`circle`,{cx:`7.5`,cy:`7.5`,r:`.5`,fill:`currentColor`,key:`kqv944`}]]),_=h(),v=p();function y(){let{foundBugs:p,addBug:h,resetProgress:g,getBugDifficulty:y,xp:b,getBugPoints:x,deductXP:S}=oe(),{newAchievement:C,checkAchievements:w}=re(),{showAnimation:fe,animationData:T,triggerBugAnimation:E}=o(),{addLog:D,addRequest:O}=ae(),[k,A]=(0,_.useState)(1),[j,M]=(0,_.useState)(``),[N,P]=(0,_.useState)(null),[F,pe]=(0,_.useState)(5),[I,L]=(0,_.useState)(!1),[R,z]=(0,_.useState)(!1),[B,V]=(0,_.useState)({}),[me,he]=(0,_.useState)({}),[H]=(0,_.useState)([{id:`neg_qty`,description:`Məhsul sayı mənfi ola bilir (-1)`,severity:`Critical`,priority:`High`},{id:`zero_qty`,description:`Məhsul sayı 0 ola bilir`,severity:`Major`,priority:`Medium`},{id:`float_qty`,description:`Məhsul sayı kəsr ola bilir (1.5)`,severity:`Major`,priority:`Medium`},{id:`price_calc`,description:`Endirim hesablanarkən qiymət artır`,severity:`Critical`,priority:`High`},{id:`img_broken`,description:`Məhsul şəkli yüklənməyib`,severity:`Minor`,priority:`Low`},{id:`del_btn`,description:`Silmə düyməsi işləmir`,severity:`Major`,priority:`Medium`},{id:`stock_limit`,description:`Stokda olandan çox məhsul seçmək olur`,severity:`Major`,priority:`Medium`},{id:`product_typo`,description:`Məhsul adında səhv: "iPhone" əvəzinə "iPone"`,severity:`Minor`,priority:`Low`},{id:`currency_symbol`,description:`Valyuta simvolu yanlışdır ($ əvəzinə ₼)`,severity:`Minor`,priority:`Low`},{id:`coupon_100`,description:`Kupon kodu "FREE100" 100% endirim verir`,severity:`Minor`,priority:`Low`},{id:`no_size`,description:`Ölçü seçimi yoxdur`,severity:`Minor`,priority:`Low`},{id:`no_color`,description:`Rəng seçimi yoxdur`,severity:`Minor`,priority:`Low`},{id:`img_no_alt`,description:`Şəkildə alt atributu yoxdur (accessibility)`,severity:`Minor`,priority:`Low`},{id:`price_alignment`,description:`Qiymət sağa deyil, sola yönəlib`,severity:`Minor`,priority:`Low`},{id:`btn_typo`,description:`Düymədə səhv: "rəsmiləşdir" əvəzinə "rəsmiləşdır"`,severity:`Minor`,priority:`Low`},{id:`total_font`,description:`Yekun məbləğ şrifti çox kiçikdir`,severity:`Minor`,priority:`Low`},{id:`qty_btn_size`,description:`Miqdar düymələri fərqli ölçüdədir`,severity:`Minor`,priority:`Low`},{id:`discount_color`,description:`Endirim mənfi olduğu halda yaşıl rəngdədir`,severity:`Minor`,priority:`Low`},{id:`checkout_disabled`,description:`Checkout düyməsi heç vaxt disabled olmur`,severity:`Major`,priority:`Medium`},{id:`stock_info`,description:`Stok məlumatı göstərilmir`,severity:`Major`,priority:`Medium`}]),[ge,U]=(0,_.useState)(!1),[W,G]=(0,_.useState)(null),K=e=>{p.includes(e)||(G(e),U(!0))},q=e=>{let t=h(e);if(t.isNew){let n=H.find(t=>t.id===e);E({...t,bugName:n.description}),w({foundBugs:[...p,e],totalBugs:H.length,moduleBugs:{ecommerce:H},getBugDifficulty:y})}},_e=({severity:e,priority:t})=>{let n=H.find(e=>e.id===W),r=0;e===n.severity&&(r+=5),t===n.priority&&(r+=5);let i=x(y(W))+r;h(W),E({isNew:!0,points:i,bugName:n.description}),U(!1),G(null),w({foundBugs:[...p,W],totalBugs:H.length,moduleBugs:{ecommerce:H},getBugDifficulty:y})},ve=()=>{let e={},t=[];return k<0&&(t.push(`neg_qty`),e.quantity=`Məhsul sayı mənfi ola bilməz`),k===0&&(t.push(`zero_qty`),e.quantity=`Məhsul sayı 0 ola bilməz`),k%1!=0&&(t.push(`float_qty`),e.quantity=`Məhsul sayı tam ədəd olmalıdır`),k>F&&(t.push(`stock_limit`),e.quantity=`Stokda yalnız ${F} ədəd var`),t.push(`btn_typo`),t.push(`checkout_disabled`),V(e),{isValid:Object.keys(e).length===0,detectedBugs:t}},ye=()=>{let e=k-1;A(e),e===0&&q(`zero_qty`),e<0&&q(`neg_qty`)},be=()=>{let e=k+1;A(e),e>F&&q(`stock_limit`)},J=e=>{let t=parseFloat(e.target.value);A(t),t%1!=0&&q(`float_qty`)},xe=()=>{q(`del_btn`)},Se=()=>{D(`info`,`Attempting to apply coupon: ${j}`),j.toUpperCase()===`FREE100`?(q(`coupon_100`),P({code:`FREE100`,discount:100}),D(`success`,`Coupon applied successfully`,{code:`FREE100`,discount:100})):j&&D(`warn`,`Invalid coupon code`,{code:j})},Ce=async()=>{let{isValid:e,detectedBugs:t}=ve();if(t.forEach(e=>{q(e),p.includes(e)}),!e){Object.values(B)[0],D(`warn`,`Checkout validation failed`,B);return}z(!0),D(`info`,`Starting checkout process...`,{items:k,total:Z}),await new Promise(e=>setTimeout(e,1500)),z(!1),O(`POST`,`https://api.shop.com/v1/checkout`,200,1500,{success:!0,orderId:`ORD-998877`}),D(`info`,`Checkout completed successfully`),F===F&&q(`stock_info`)},Y=2999,X=N?N.discount/100*Y*k:-50,Z=Y*k+X,Q=H,$=p.filter(e=>Q.find(t=>t.id===e));return(0,_.useEffect)(()=>{$.length===Q.length&&Q.length>0&&ce()},[$.length,Q.length]),(0,v.jsxs)(se,{className:`p-6 pt-12 pb-24 min-h-screen`,children:[(0,v.jsx)(n,{isOpen:I,onClose:()=>L(!1),spec:s.ecommerce}),(0,v.jsx)(ie,{children:fe&&T&&(0,v.jsx)(r,{bugName:T.bugName,points:T.points,onComplete:()=>{}})}),C&&(0,v.jsx)(m,{achievement:C,onClose:()=>{}}),(0,v.jsxs)(`header`,{className:`mb-8`,children:[(0,v.jsxs)(f,{to:`/practice`,className:`inline-flex items-center text-slate-500 mb-4 hover:text-slate-800 transition-colors`,children:[(0,v.jsx)(e,{size:20,className:`mr-1`}),`Geri qayıt`]}),(0,v.jsxs)(`div`,{className:`flex justify-between items-start`,children:[(0,v.jsxs)(`div`,{children:[(0,v.jsx)(`h1`,{className:`text-3xl font-black text-slate-900 tracking-tight mb-2`,children:`Səbət`}),(0,v.jsxs)(`div`,{className:`flex items-center gap-2 text-slate-500 font-medium`,children:[(0,v.jsx)(ne,{size:18}),(0,v.jsxs)(`p`,{children:[`Bu səhifədə `,H.length,` baq gizlənib.`]})]})]}),(0,v.jsx)(`button`,{onClick:()=>L(!0),className:`p-3 bg-indigo-100 text-indigo-600 rounded-xl hover:bg-indigo-200 transition-colors`,children:(0,v.jsx)(c,{size:24})})]})]}),(0,v.jsxs)(`div`,{className:`bg-white p-6 rounded-[2rem] shadow-xl shadow-orange-200/50 border border-slate-100 relative overflow-hidden mb-8`,children:[(0,v.jsx)(`div`,{className:`absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-orange-500 to-red-500`}),(0,v.jsxs)(`div`,{className:`flex gap-4 mb-6`,children:[(0,v.jsx)(`div`,{className:`w-24 h-24 bg-slate-100 rounded-xl flex items-center justify-center cursor-pointer`,onClick:()=>{K(`img_broken`),K(`img_no_alt`)},children:(0,v.jsx)(`span`,{className:`text-xs text-slate-400`,children:`Image Error`})}),(0,v.jsxs)(`div`,{className:`flex-1`,children:[(0,v.jsx)(`h3`,{className:`font-bold text-slate-900 cursor-pointer`,onClick:()=>K(`product_typo`),children:`iPone 15 Pro Max`}),(0,v.jsx)(`p`,{className:`text-slate-500 text-sm mb-2`,children:`Titanium Blue, 256GB`}),(0,v.jsxs)(`div`,{className:`flex gap-2 mb-2`,children:[(0,v.jsx)(`span`,{className:`text-xs text-slate-400 cursor-pointer hover:text-red-500`,onClick:()=>K(`no_size`),children:`Ölçü: ?`}),(0,v.jsx)(`span`,{className:`text-xs text-slate-400 cursor-pointer hover:text-red-500`,onClick:()=>K(`no_color`),children:`Rəng: ?`})]}),(0,v.jsxs)(`div`,{className:`flex items-center gap-2 cursor-pointer`,onClick:()=>K(`price_alignment`),children:[(0,v.jsxs)(`span`,{className:`font-bold text-lg cursor-pointer`,onClick:e=>{e.stopPropagation(),K(`currency_symbol`)},children:[`$`,Y]}),(0,v.jsxs)(`span`,{className:`text-sm text-red-500 line-through cursor-pointer`,onClick:e=>{e.stopPropagation(),K(`price_calc`)},children:[`$`,Y-500]})]})]})]}),(0,v.jsxs)(`div`,{className:`flex items-center justify-between bg-slate-50 p-4 rounded-xl mb-6`,children:[(0,v.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,v.jsx)(`button`,{onClick:()=>{ye(),K(`qty_btn_size`)},className:`w-10 h-8 bg-white rounded-full shadow-sm flex items-center justify-center text-slate-600 hover:bg-slate-100 transition-colors`,children:(0,v.jsx)(le,{size:16})}),(0,v.jsx)(`input`,{type:`number`,step:`0.1`,value:k,onChange:J,className:`font-bold w-16 text-center border-2 rounded-lg p-1 outline-none transition-colors ${B.quantity?`border-red-300`:`border-slate-200`}`}),(0,v.jsx)(`button`,{onClick:be,className:`w-8 h-8 bg-white rounded-full shadow-sm flex items-center justify-center text-slate-600 hover:bg-slate-100 transition-colors`,children:(0,v.jsx)(u,{size:16})})]}),(0,v.jsxs)(`div`,{className:`flex items-center gap-4`,children:[(0,v.jsxs)(`div`,{className:`flex items-center gap-2 cursor-pointer opacity-50`,onClick:()=>K(`stock_info`),children:[(0,v.jsx)(ue,{size:16,className:`text-slate-400`}),(0,v.jsx)(`span`,{className:`text-xs text-slate-400`,children:`Stok: ?`})]}),(0,v.jsx)(`button`,{className:`text-slate-400 hover:text-red-500 transition-colors`,onClick:xe,children:(0,v.jsx)(d,{size:20})})]})]}),B.quantity&&(0,v.jsxs)(`div`,{className:`flex items-center gap-2 mb-4 text-red-600 text-sm bg-red-50 p-3 rounded-xl`,children:[(0,v.jsx)(t,{size:16}),(0,v.jsx)(`span`,{children:B.quantity})]}),(0,v.jsxs)(`div`,{className:`mb-6`,children:[(0,v.jsxs)(`label`,{className:`block text-sm font-bold text-slate-700 mb-2 flex items-center gap-2`,children:[(0,v.jsx)(de,{size:16}),`Kupon Kodu`]}),(0,v.jsxs)(`div`,{className:`flex flex-col sm:flex-row gap-2 items-start sm:items-center`,children:[(0,v.jsx)(`input`,{type:`text`,placeholder:`Kupon kodu`,className:`flex-1 w-full p-3 border-2 border-slate-200 rounded-xl outline-none focus:border-orange-500 transition-colors`,value:j,onChange:e=>M(e.target.value)}),(0,v.jsxs)(`div`,{className:`relative group`,children:[(0,v.jsx)(te,{size:16,className:`text-slate-400 cursor-pointer`}),(0,v.jsx)(`div`,{className:`absolute left-0 mt-1 w-48 p-2 bg-gray-800 text-white text-xs rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none`,children:`Kupon kodunu daxil edin (məsələn FREE100)`})]}),(0,v.jsx)(`button`,{onClick:Se,className:`w-full sm:w-auto px-4 py-2 bg-orange-100 text-orange-600 rounded-xl font-bold hover:bg-orange-200 transition-colors mt-2 sm:mt-0`,children:`Tətbiq et`})]}),N&&(0,v.jsxs)(`div`,{className:`flex items-center gap-2 mt-2 text-green-600 text-sm`,children:[(0,v.jsx)(ee,{size:16}),(0,v.jsxs)(`span`,{children:[`Kupon tətbiq edildi: `,N.discount,`% endirim`]})]})]}),(0,v.jsxs)(`div`,{className:`border-t border-slate-100 pt-4 space-y-2`,children:[(0,v.jsxs)(`div`,{className:`flex justify-between text-slate-600`,children:[(0,v.jsxs)(`span`,{children:[`Məhsullar (`,k,`)`]}),(0,v.jsxs)(`span`,{children:[`$`,Y*k]})]}),(0,v.jsxs)(`div`,{className:`flex justify-between text-green-600 font-medium cursor-pointer`,onClick:()=>K(`discount_color`),children:[(0,v.jsx)(`span`,{children:`Endirim`}),(0,v.jsxs)(`span`,{children:[X>0?`-`:`+`,`$`,Math.abs(X)]})]}),(0,v.jsxs)(`div`,{className:`flex justify-between font-black text-xl text-slate-900 pt-2 cursor-pointer`,onClick:()=>K(`total_font`),children:[(0,v.jsx)(`span`,{className:`text-xs`,children:`Cəmi`}),(0,v.jsxs)(`span`,{className:`text-xs`,children:[`$`,Z]})]})]}),(0,v.jsx)(`button`,{onClick:Ce,disabled:R,className:`w-full mt-6 py-4 bg-orange-500 text-white rounded-xl font-bold shadow-lg shadow-orange-200 hover:bg-orange-600 transition-colors cursor-pointer disabled:opacity-50 flex items-center justify-center gap-2`,children:R?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(l,{className:`animate-spin`,size:20}),(0,v.jsx)(`span`,{children:`Emal edilir...`})]}):`Sifarişi rəsmiləşdır`})]}),(0,v.jsx)(a,{bugs:H,foundBugs:p,onReset:g,xp:b,getBugPoints:x,getBugDifficulty:y,deductXP:S}),(0,v.jsx)(i,{isOpen:ge,onClose:()=>U(!1),onSubmit:_e,bug:H.find(e=>e.id===W)})]})}export{y as default};